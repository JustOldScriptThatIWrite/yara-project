#summary Guidelines to get the best performance from YARA.

When creating your rules for YARA keep in mind the following guidelines in order to get the best performance from them:

 * Avoid using wild-cards or jumps before the first two byes of the strings. YARA does its best effort to scan your files as fast as possible, for this purpose it stores the declared strings in a hash table, where the hash key are the first two bytes of the string. Those strings that don't have the first two bytes strictly defined can't be stored on the hash table, slowing down the scanning process.  
{{{
   $a = { EB ?? 00 34 12 0F }  /* bad, wild-card on second byte */
   $a = { EB 00 ?? 34 12 0F }  /* ok */  
 
   $a = /.*ab/  /* bad, regular expression starting with wild-card */
   $a = /ab.*/  /* ok, regular expression have the first two chars well defined */
}}}   

 * When using jumps keep the length range as short as posible. Although YARA allows creating jumps with a length ranging from 0-255 is not a good idea to do so, you better keep jump ranges short.
{{{
   $a = { FF 25 00 [0-200] FF 25 }  /* bad, range from 0 to 200 too wide */
   
   $a = { FF 25 00 [0-8] FF 25 }      /* ok */  
   $a = { FF 25 00 [200-210] FF 25 }  /* ok */  
}}}

 * Avoid defining too short strings. Any string with less than 5 or 6 bytes will probably appear in a lot of files.

 * Use regular expressions only when necessary. Regular expression evaluation is inherently slow, don't use them if hex strings with jumps and wild-cards can solve the problem.

 